---
title: "Visualising Pokemon data from Pokemon GO GAME_MASTER file"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Visualising Pokemon data from Pokemon GO GAME_MASTER file}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteDepends{dplyr,pogor,plotly,ggplot2}
  \usepackage[utf8]{inputenc}
---

```{r, message=FALSE, warning=FALSE}
library(plotly)
library(ggplot2)
library(pogor)
library(dplyr)
type_ggcols = scale_color_manual(values=paste0("#",types$type_color))
```

# Plot base stats 

```{r}
p <- ggplot(pkmn, aes(x=stats.baseAttack, y=stats.baseDefPlusStam, text=pokemonId)) + 
  geom_point(aes(col=type)) + type_ggcols
p <- ggplotly(p, width=720, height=720)
p
```

Flaws: 
some are on top of each other e.g. 
Kyogre hidden under Groudon, as same stats. 
Also Magikarp and Feebas

Dual typing not shown. 
Primary typing sometimes doesn't match typical use / moves, e.g. Lapras, Cloyster are water. 
Could solve by plotting multiple points for each dual typed mon.

Nice features - can highlight Pokemon of a particular type - try it out. 



# Visualise capture rate and flee rate 
Jitter these on their 10 or so unique values 

```{r}
summary(pkmn$encounter.baseCaptureRate)
table(pkmn$encounter.baseCaptureRate)
summary(pkmn$encounter.baseFleeRate)
table(pkmn$encounter.baseFleeRate)
```

```{r}
p <- ggplot(pkmn, aes(x=encounter.baseCaptureRate, y=encounter.baseFleeRate, text=pokemonId)) + 
  geom_jitter(aes(col=type), width=0.015, height=0.002) +
  scale_y_continuous(breaks=unique(pkmn$encounter.baseFleeRate), limits=c(0,0.22)) + 
  scale_x_continuous(breaks=sort(unique(pkmn$encounter.baseCaptureRate)), 
                     labels=c("", "", 0.05, "", 0.1, "", 0.15, 0.2, 0.25, 0.3, 0.4, 0.5, 0.6, 0.7, 0.9)) + 
  annotate(geom="text", x=0.5, y=0.22, label="Excluded ABRA: baseCaptureRate=0.5, baseFleeRate=0.9") + 
  type_ggcols
ggplotly(p, tooltip=c("text", "x", "y"), width=720, height=720)
```

TODO hard - red to green colour gradient as capture ring?
hjust is not passed to ggplotly. bug report? 
hard - don't jitter if only one point. 


# 8 variables for animation time? 


# Collision height against collision radius
```{r}
p <- ggplot(pkmn, aes(x=encounter.collisionRadiusM, y=encounter.collisionHeightM, text=pokemonId)) + 
  geom_point(aes(col=type)) + type_ggcols
ggplotly(p)
```

# Collision head radius (?) against collision radius
```{r}
p <- ggplot(pkmn, aes(x=encounter.collisionRadiusM, y=encounter.collisionHeadRadiusM, text=pokemonId)) + 
  geom_point(aes(col=type)) + type_ggcols
ggplotly(p)
```

# Collision radius against camera distance
```{r}
p <- ggplot(pkmn, aes(x=encounter.collisionRadiusM, y=encounter.cameraDistance, text=pokemonId)) + 
  geom_point(aes(col=type)) + type_ggcols
ggplotly(p)
```

why does eevee have a bigger collision radius than sentret?  Camera distances are very similar

Variables determining Pokemon activity while catching (see recent silph road analysis (?) explaining these)

[15] "encounter.movementType"              
[16] "encounter.movementTimerS"            
[17] "encounter.jumpTimeS"                 
[18] "encounter.attackTimerS"              
[19] "encounter.attackProbability"         
[20] "encounter.dodgeProbability"          
[21] "encounter.dodgeDurationS"            
[22] "encounter.dodgeDistance"             
[24] "encounter.minPokemonActionFrequencyS"
[25] "encounter.maxPokemonActionFrequencyS"


# height and weight with SD TODO